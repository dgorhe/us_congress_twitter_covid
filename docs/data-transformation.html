<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Data transformation | US Congress - Tweets and COVID-19</title>
  <meta name="description" content="Chapter 3 Data transformation | US Congress - Tweets and COVID-19" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Data transformation | US Congress - Tweets and COVID-19" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Data transformation | US Congress - Tweets and COVID-19" />
  
  
  

<meta name="author" content="Darvesh Gorhe, Thomas Holvoet, Nicolo Ricci" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sources.html"/>
<link rel="next" href="missing-values.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/parallel-coordinates-2.1.8/parcoords.css" rel="stylesheet" />
<script src="libs/parcoords-binding-1.0.0/parcoords.js"></script>
<script src="libs/d3-5.16.0/d3.min.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">US Congress Tweet Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#congress-and-mobility"><i class="fa fa-check"></i><b>1.1</b> Congress and Mobility</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#congress-and-sentiment"><i class="fa fa-check"></i><b>1.2</b> Congress and Sentiment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#congress-members-tweets"><i class="fa fa-check"></i><b>2.1</b> Congress Members Tweets</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#googles-changes-in-mobility-data"><i class="fa fa-check"></i><b>2.2</b> Google’s Changes in Mobility Data</a></li>
<li class="chapter" data-level="2.3" data-path="data-sources.html"><a href="data-sources.html#number-of-tweets-cases-and-mobility"><i class="fa fa-check"></i><b>2.3</b> Number of tweets cases and mobility</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#congress-members-tweets-1"><i class="fa fa-check"></i><b>3.1</b> Congress Members Tweets</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data-transformation.html"><a href="data-transformation.html#tweet-cleaning-process"><i class="fa fa-check"></i><b>3.1.1</b> Tweet Cleaning Process</a></li>
<li class="chapter" data-level="3.1.2" data-path="data-transformation.html"><a href="data-transformation.html#appending-zero-shot-classification-labels"><i class="fa fa-check"></i><b>3.1.2</b> Appending Zero Shot Classification Labels</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#googles-changes-in-mobility-data-1"><i class="fa fa-check"></i><b>3.2</b> Google’s Changes in Mobility Data</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#number-of-tweets-cases-and-mobility-1"><i class="fa fa-check"></i><b>3.3</b> Number of tweets cases and mobility</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a>
<ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#excluding-tweet-content-from-missing-values"><i class="fa fa-check"></i><b>4.1</b> Excluding Tweet Content from Missing Values</a></li>
<li class="chapter" data-level="4.2" data-path="missing-values.html"><a href="missing-values.html#geo"><i class="fa fa-check"></i><b>4.2</b> Geo</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="missing-values.html"><a href="missing-values.html#impact-of-missing-geo-values"><i class="fa fa-check"></i><b>4.2.1</b> Impact of Missing Geo Values</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="missing-values.html"><a href="missing-values.html#language"><i class="fa fa-check"></i><b>4.3</b> Language</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="missing-values.html"><a href="missing-values.html#impact-of-missing-lang-values"><i class="fa fa-check"></i><b>4.3.1</b> Impact of Missing Lang Values</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="missing-values.html"><a href="missing-values.html#other-columns"><i class="fa fa-check"></i><b>4.4</b> Other Columns</a></li>
<li class="chapter" data-level="4.5" data-path="missing-values.html"><a href="missing-values.html#number-of-tweets-cases-and-mobility-2"><i class="fa fa-check"></i><b>4.5</b> Number of tweets cases and mobility</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#covid-vs.-mobility"><i class="fa fa-check"></i><b>5.1</b> COVID vs. Mobility</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analyzing-the-policy-of-representatives-of-congress-through-their-tweets.html"><a href="analyzing-the-policy-of-representatives-of-congress-through-their-tweets.html"><i class="fa fa-check"></i><b>6</b> Analyzing the policy of representatives of Congress through their tweets</a>
<ul>
<li class="chapter" data-level="6.1" data-path="analyzing-the-policy-of-representatives-of-congress-through-their-tweets.html"><a href="analyzing-the-policy-of-representatives-of-congress-through-their-tweets.html#extracting-the-data"><i class="fa fa-check"></i><b>6.1</b> Extracting the data</a></li>
<li class="chapter" data-level="6.2" data-path="analyzing-the-policy-of-representatives-of-congress-through-their-tweets.html"><a href="analyzing-the-policy-of-representatives-of-congress-through-their-tweets.html#patterns-in-policy"><i class="fa fa-check"></i><b>6.2</b> Patterns in policy</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>7</b> Interactive component</a></li>
<li class="chapter" data-level="8" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>8</b> Conclusion</a>
<ul>
<li class="chapter" data-level="8.1" data-path="conclusion.html"><a href="conclusion.html#number-of-tweets-cases-and-mobility-3"><i class="fa fa-check"></i><b>8.1</b> Number of tweets cases and mobility</a></li>
<li class="chapter" data-level="8.2" data-path="conclusion.html"><a href="conclusion.html#congress-members-tweets-2"><i class="fa fa-check"></i><b>8.2</b> Congress Members Tweets</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">US Congress - Tweets and COVID-19</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-transformation" class="section level1" number="3">
<h1><span class="header-section-number">Chapter 3</span> Data transformation</h1>
<div id="congress-members-tweets-1" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Congress Members Tweets</h2>
<p>Some fields had the majority of their values missing and thus the feature itself is ignored. This was the case with the geolocation feature. We did not know ahead of time whether this would be useful and if it was more common, it might have allowed us to perform district level analyses for the US Congress members. Much of the cleaning was done when the data was being retrieved via the Twitter API. We used the new Tweepy python package and Python 3.9 to retrieve tweets from Twitter’s V2 API endpoint. This new version of the endpoint provides features which were not utilized for this analysis. We chose the V2 endpoint to ensure that others can replicate our findings for as long as possible. The old API is not yet deprecated so the tweet retrieval is probably translatable to the V1.1 API although this has not been tested. The web scraping script can be found in the repository. The dataset of tweets is approximately 100 megabytes (Mb) and contains roughly 400,000 tweets across all US Congress Members.</p>
<div id="tweet-cleaning-process" class="section level3" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Tweet Cleaning Process</h3>
<p>Most of the work was involved in cleaning the dataset. There were tweets returned which either did not have an id or did not contain any text. The presumption is that these tweets may have been posted and later retracted but the tweet ids remained linked to the congress member’s account within Twitter’s database. There was one tweet missing the Twitter handle which was eliminated. A more common issue was duplicate tweets. Understandably, members of the US Congress discuss matters via Twitter and there are often threads where members overlap. However, this only accounted for about 10,000 tweets removed out of the approximately 410,000 tweets initially scraped. We also removed emojis from tweets for easier processing and parsing of information. Emojis, as opposed to other unicode characters, caused issues in particular. Perhaps there is some insightful things to learn from US Congress members’ use of emojis but that could be a topic for future studies.</p>
</div>
<div id="appending-zero-shot-classification-labels" class="section level3" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Appending Zero Shot Classification Labels</h3>
<p>Zero-shot classification of tweet content was done via Google Colab Notebooks using the open source transformers package. This package included BERT and GPU inference was used to speed up labeling. Labels were stored separately and then appended to the tweet data after the fact.</p>
</div>
</div>
<div id="googles-changes-in-mobility-data-1" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Google’s Changes in Mobility Data</h2>
<p>This data was provided directly by Google and can be found (here)[<a href="https://www.google.com/covid19/mobility/" class="uri">https://www.google.com/covid19/mobility/</a>]. The US data lists relative changes in mobility at the state and county level. We will only use data from states because for most states multiple counties correspond to a single congressional district. The more important problem occurs when a single county is represented by multiple congressional districts (e.g Los Angeles County in California). If the many-to-one relationship only existed in one direction. We could theoretically, manually map congressional districts to counties or vice versa in a consistent manner. We could assume that counties with many districts have representatives who are equally influential but that assumption could sway our results significantly. For example, if we aggregate representatives from multiple districts into the county shared by those districts, we are assuming the representatives are acting independently which is a tenuous assumption at best. Representatives from the same county likely have similar constituents and goals so any uniformity from their tweet content would suggest a stronger relationship between mobility and tweets than would be otherwise. In the future, people could experiment with different weightings to make this corresponding more representative.</p>
</div>
<div id="number-of-tweets-cases-and-mobility-1" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Number of tweets cases and mobility</h2>
<p>As said, the data was provided by the three different datasets. One stating the cases and deaths (we’ll call it t1 from now on) for each country in each day, the other is a webscraped version of the number of tweets where the top 1000 covid-related bigrams are present (we’ll call it t2).
Looking at t1, we filter the table on the country and on the date. Indeed, we are going to pick only USA data, and data that starts from 4/1/2020 to 12/15/2020. Filtering on the USA is just a way to reduce our dataset, even though our twitter bigrams data is counting all bigrams in the world, it is clear that the majority of tweets come from the USA.
For t2, we are also limiting our dates to the range 4/1/2020 to 12/15/2020. Furthermore, we are limiting the analysis to the top 50 bigrams instead of the 1000.We do this to sample the initial dataframe and have an easier approach when writing the code. We decided to get the related bigrams we wanted to include the bigram ‘covid 19’ which we believe is the most used bigrams when it comes to covid related words. Of course a similar analysis may be done on monograms and trigrams. The webscraping script can be found in the repository.
At the same time, we tried establishing a relationship between mobility, covid, and twitter data. To do this we used a part of USA mobility Data which was explained before</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="missing-values.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dgorhe/us_congress_twitter_covid/edit/main/03-cleaning.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/dgorhe/us_congress_twitter_covid/blob/main/03-cleaning.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
